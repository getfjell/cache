
> @fjell/cache@4.7.41-dev.0 test
> vitest run --coverage


 RUN  v4.0.1 ~/gitw/getfjell/cache
      Coverage enabled with v8

stderr | tests/eviction/strategies/LFUEvictionStrategy.test.ts > LFUEvictionStrategy > Configuration Validation and Sanitization Tests > should handle invalid configuration values gracefully
decayFactor must be between 0 and 1, got -0.5. Correcting to 0.
sketchWidth must be positive, got -10. Correcting to 1024.
sketchDepth must be positive, got 0. Correcting to 4.

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Basic Properties > should have correct implementation type
(1763111335078) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Basic Properties > should report two-layer enabled
(1763111335079) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Basic Properties > should provide access to underlying cache
(1763111335079) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through get operations
(1763111335079) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through set operations and invalidate queries
(1763111335081) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through delete operations and invalidate queries
(1763111335081) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through includes key operations
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through allIn operations
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through queryIn operations
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should pass through contains operations
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Item Operations > should handle clear operations and metadata
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Operations > should set and get query results with metadata
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Operations > should handle query result expiration based on TTL
(1763111335082) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stderr | tests/memory/MemoryCacheMap.test.ts > MemoryCacheMap > Constructor with Initial Data > should handle invalid JSON keys in initial data gracefully
(1763111335088) [ERROR] - [@fjell/cache] [MemoryCacheMap] Failed to parse initial data key [{"keyStr":"invalid-json","error":{}}]

stderr | tests/ops/set.test.ts > set operation > input validation > should throw error for undefined key
(1763111335093) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: 

stderr | tests/ops/set.test.ts > set operation > input validation > should throw error for empty object key
(1763111335093) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: {}

stderr | tests/ops/set.test.ts > set operation > input validation > should throw error for malformed key
(1763111335094) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: {"invalid":"key"}

stderr | tests/ops/set.test.ts > set operation > input validation > should throw error for incomplete primary key
(1763111335094) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: {"kt":"test"}

stderr | tests/ops/set.test.ts > set operation > input validation > should throw error for incomplete composite key
(1763111335094) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"test","pk":"1"} != {"kt":"test","pk":"3","loc":[{"kt":"container","lk":"container1"}]}

stderr | tests/ops/set.test.ts > set operation > key matching validation > should throw error when key does not match item key
(1763111335095) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"test","pk":"different"} != {"kt":"test","pk":"1"}

stderr | tests/ops/set.test.ts > set operation > key matching validation > should throw error when primary key type differs
(1763111335095) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"different","pk":"1"} != {"kt":"test","pk":"1"}

stderr | tests/ops/set.test.ts > set operation > key matching validation > should throw error when composite key location differs
(1763111335095) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"test","pk":"3","loc":[{"kt":"container","lk":"different"}]} != {"kt":"test","pk":"3","loc":[{"kt":"container","lk":"container1"}]}

stderr | tests/ops/set.test.ts > set operation > edge cases and error scenarios > should handle null values in key normalization gracefully
(1763111335100) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: {"kt":"test","pk":null}

stderr | tests/ops/set.test.ts > set operation > edge cases and error scenarios > should handle empty string keys as invalid
(1763111335101) [ERROR] - [@fjell/cache] [set] Key for Set is not a valid ItemKey: {"kt":"test","pk":""}

 âœ“ tests/eviction/strategies/LFUEvictionStrategy.test.ts (50 tests) 65ms
 âœ“ tests/ops/set.test.ts (44 tests) 26ms
 âœ“ tests/eviction/EvictionStrategyFactory.test.ts (33 tests) 32ms
 âœ“ tests/memory/MemoryCacheMap.test.ts (76 tests) 63ms
stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Auto-Detection > should use provided options in auto-detected cache
(1763111335154) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"browser/indexedDB","itemTTL":7200,"queryTTL":600,"facetTTL":120}]
(1763111335154) [INFO] - [@fjell/cache] [TwoLayerFactory] Created two-layer cache from config [{"itemLayerType":"indexedDB","queryTTL":600,"facetTTL":120}]

stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Wrapper Functionality > should wrap different cache implementations correctly
(1763111335155) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335155) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/enhanced","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Factory Method Options > should handle custom configurations for each method
(1763111335155) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":1800,"queryTTL":180,"facetTTL":30}]
(1763111335156) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"browser/indexedDB","itemTTL":1800,"queryTTL":180,"facetTTL":30}]

 âœ“ tests/examples/enhanced-eviction-examples.test.ts (23 tests) 152ms
stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Debug and Logging > should handle debug logging in factory creation
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerFactory] Created two-layer cache from config [{"itemLayerType":"memory"}]

stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Debug and Logging > should create caches with debug mode enabled
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"browser/indexedDB","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"browser/localStorage","itemTTL":3600,"queryTTL":180,"facetTTL":30}]

stdout | tests/cache/TwoLayerFactory.test.ts > TwoLayerFactory > Factory Performance > should handle concurrent factory calls
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335157) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]
(1763111335158) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

 â¯ tests/cache/TwoLayerFactory.test.ts (42 tests | 1 failed) 11ms
       âœ“ should create memory two-layer cache 1ms
       âœ“ should create enhanced memory two-layer cache 0ms
       âœ“ should create IndexedDB two-layer cache 0ms
       âœ“ should create localStorage two-layer cache with space management 0ms
       âœ“ should create sessionStorage two-layer cache 0ms
       âœ“ should create hybrid two-layer cache 0ms
       âœ“ should create two-layer cache when enabled in config 0ms
       âœ“ should create single-layer cache when disabled in config 0ms
       âœ“ should handle different item layer types in config 0ms
       âœ“ should handle unknown cache types gracefully 0ms
       âœ“ should pass layer options correctly 0ms
       âœ“ should handle missing options in config 0ms
       Ã— should auto-detect cache type for current environment 3ms
       âœ“ should use provided options in auto-detected cache 1ms
       âœ“ should handle auto-detection with minimal options 0ms
       âœ“ should detect best cache type for different environments 0ms
       âœ“ should handle factory creation errors gracefully 0ms
       âœ“ should handle invalid configuration gracefully 0ms
       âœ“ should handle missing required parameters 0ms
       âœ“ should create wrapper around existing cache 0ms
       âœ“ should handle wrapping with default options 0ms
       âœ“ should wrap different cache implementations correctly 0ms
       âœ“ should handle default options for each factory method 0ms
       âœ“ should apply storage-specific TTL optimizations 0ms
       âœ“ should handle custom configurations for each method 0ms
       âœ“ should handle empty configuration objects 0ms
       âœ“ should handle partial configuration 0ms
       âœ“ should handle nested option configurations 0ms
       âœ“ should handle null/undefined types gracefully 0ms
       âœ“ should handle empty types array 0ms
       âœ“ should handle invalid size configurations 0ms
       âœ“ should handle IndexedDB configuration edge cases 0ms
       âœ“ should handle storage configuration edge cases 0ms
       âœ“ should handle unknown cache types in private createSingleLayerCache 0ms
       âœ“ should handle createSingleLayerCache with various options 0ms
       âœ“ should handle debug logging in factory creation 0ms
       âœ“ should create caches with debug mode enabled 0ms
       âœ“ should properly wrap different CacheMap types 0ms
       âœ“ should preserve underlying cache properties 0ms
       âœ“ should handle cache creation with complex type hierarchies 0ms
       âœ“ should create instances efficiently 0ms
       âœ“ should handle concurrent factory calls 0ms
stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Operations > should delete query results and metadata
(1763111335233) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Operations > should determine query completeness correctly
(1763111335234) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Operations > should handle query result with empty item keys
(1763111335234) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Invalidation > should invalidate queries containing modified items
(1763111335234) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Invalidation > should handle invalidation of non-existent queries gracefully
(1763111335234) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Invalidation > should invalidate multiple queries for single item change
(1763111335235) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Statistics and Cleanup > should provide two-layer statistics
(1763111335235) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Statistics and Cleanup > should clean up expired queries
(1763111335235) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stderr | tests/ops/get.test.ts > get operation > input validation > should throw error for invalid key
(1763111335269) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in get [{"key":{"invalid":"key"},"coordinate":{"kta":["test"],"scopes":[]}}]

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage

ðŸš€ Fjell-Cache Basic Example
============================

This example demonstrates basic cache operations with User and Task models.

Step 1: Setting up cache infrastructure
--------------------------------------
âœ… Created cache registry
âœ… Created mock APIs for users and tasks

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
âœ… Created cache instances (which are now also instances)
âœ… Created cache model instances

Step 2: Creating test data
-------------------------
âœ… Created user: Alice Johnson (alice@example.com)
âœ… Created user: Bob Smith (bob@example.com)
âœ… Created task: Setup project repository
âœ… Created task: Implement user authentication
âœ… Created test users and tasks

Step 3: Cache operations - Fetching all items
----------------------------------------------

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“¦ Fetching all users from storage...

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“‹ Cached 2 users: [ 'Alice Johnson', 'Bob Smith' ]

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“¦ Fetching all tasks from storage...

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“‹ Cached 2 tasks: [ 'Setup project repository', 'Implement user authentication' ]

Step 4: Individual item retrieval
---------------------------------

stderr | tests/ops/get.test.ts > get operation > when bypassCache is enabled > should handle API errors properly
(1763111335273) [ERROR] - [@fjell/cache] [get] API request failed [{"key":{"kt":"test","pk":"1"},"error":{}}]

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ‘¤ Retrieved from cache: Alice Johnson (alice@example.com)

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“ Retrieved from cache: Setup project repository - Status: completed

Step 5: Cache behavior demonstration
-----------------------------------
ðŸŽ¯ Second retrieval (should hit cache):

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ‘¤ Retrieved: Alice Johnson (cache hit)
âœ… Created user: Charlie Brown (charlie@example.com)
ðŸŽ¯ New item retrieval (cache miss, will fetch from API):

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ” Getting user with key: user-3

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ‘¤ Retrieved: Charlie Brown (fetched from API and cached)

Step 6: Cache updates
--------------------

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ”„ Updated task in cache: Implement user authentication - New status: completed

Step 7: Query operations
-----------------------

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“¦ Fetching all tasks from storage...

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ” Found 2 tasks through cache query

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“ Retrieved one task: Setup project repository

Step 8: Cache management
-----------------------
ðŸ“Š Cache Statistics:
   ðŸ‘¥ Users in cache: 2
   ðŸ“ Tasks in cache: 2
   ðŸŽ¯ User cache coordinate: user
   ðŸŽ¯ Task cache coordinate: task

Step 9: Cleanup demonstration
-----------------------------
ðŸ—‘ï¸ Removed user from storage

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸŽ¯ Cache still contains removed user: Charlie Brown

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test branch patterns that mirror the example structure for increased coverage
ðŸ“‹ Fresh fetch shows 2 users (cache updated)

ðŸŽ‰ Basic Cache Example Complete!
================================

Key concepts demonstrated:
â€¢ Cache creation with registry and instances
â€¢ Basic cache operations (get, set, all, find, one)
â€¢ Cache hits vs misses
â€¢ Cache updates and management
â€¢ Integration with mock storage APIs
â€¢ Cache lifecycle and data consistency


stderr | tests/ops/get.test.ts > get operation > error handling > should propagate API errors
(1763111335279) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"test","pk":"1"},"message":"API failure","stack":"Error: API failure
    at ~/gitw/getfjell/cache/tests/ops/get.test.ts:306:24
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:157:11
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:753:26
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1602:10)
    at runTest (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1309:12)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runFiles (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1526:3)
    at startTests (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1559:3)
    at file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:76:64
    at withEnv (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:57:3)
    at run (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:72:144)
    at runBaseTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:122:2)
    at executeTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init-forks.WglB-sfY.js:24:4)
    at execute (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:99:3)
    at process.onMessage (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:164:20)"}]

stderr | tests/ops/get.test.ts > get operation > error handling > should propagate API errors even with TTL configured
(1763111335280) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"test","pk":"1"},"message":"Network error","stack":"Error: Network error
    at ~/gitw/getfjell/cache/tests/ops/get.test.ts:317:24
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:157:11
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:753:26
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1602:10)
    at runTest (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1309:12)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runFiles (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1526:3)
    at startTests (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1559:3)
    at file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:76:64
    at withEnv (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:57:3)
    at run (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:72:144)
    at runBaseTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:122:2)
    at executeTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init-forks.WglB-sfY.js:24:4)
    at execute (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:99:3)
    at process.onMessage (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:164:20)"}]

stderr | tests/ops/get.test.ts > get operation > error handling > should handle API errors with stack trace
(1763111335280) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"test","pk":"1"},"message":"Detailed API error","stack":"Error stack trace"}]

stderr | tests/memory/EnhancedMemoryCacheMap.test.ts > EnhancedMemoryCacheMap > Constructor with initial data > should handle invalid initial data keys gracefully
(1763111335281) [ERROR] - [@fjell/cache] [EnhancedMemoryCacheMap] Failed to parse initial data key [{"keyStr":"invalid-json-key","error":{}}]

stderr | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should verify cache operations with empty data scenarios
(1763111335285) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"test","pk":"missing"},"message":"Not found: missing","stack":"Error: Not found: missing
    at Object.get (~/gitw/getfjell/cache/tests/examples/basic-cache-example.integration.test.ts:98:37)
    at executeGetLogic (~/gitw/getfjell/cache/src/ops/get.ts:166:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ~/gitw/getfjell/cache/src/ops/get.ts:70:14
    at ~/gitw/getfjell/cache/node_modules/@fjell/core/dist/index.js:1872:22
    at get (~/gitw/getfjell/cache/src/ops/get.ts:74:18)"}]

stdout | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should test cache memory behavior and performance characteristics
First call: 1.23ms, Cache hit: 0.34ms

 âœ“ tests/ops/get.test.ts (34 tests) 19ms
stdout | tests/examples/cache-type-configurations-example.integration.test.ts > Cache Type Configurations Example Integration > should import and execute cache type configurations example without errors
ðŸš€ Cache Type Configuration Examples

1ï¸âƒ£ Memory Cache Configuration
Best for: Fast access, temporary data, development
âœ… Memory cache configured with:
   - Max items: 1000
   - TTL: undefinedms (0s)
   - Debug logging: true
   - Auto sync: true
   - Max retries: 3

2ï¸âƒ£ IndexedDB Cache Configuration
Best for: Large datasets, offline capability, persistent storage
âœ… IndexedDB cache configured with:
   - Database: UserAppCache
   - Version: 2
   - Store: users
   - Debug logging: false
   - Max retries: 5
   - Retry delay: 2000ms

3ï¸âƒ£ localStorage Cache Configuration
Best for: User preferences, settings, moderate-sized persistent data
âœ… localStorage cache configured with:
   - Key prefix: "myapp:users:"
   - Compression: true
   - Auto sync: false
   - Max retries: 2
   - Default expiration: 7200000ms (7200s)

4ï¸âƒ£ Environment-Based Configuration
Automatically select optimal cache based on environment
ðŸŒ Browser with IndexedDB detected - using IndexedDB
âœ… Optimal configuration selected


stdout | tests/examples/cache-type-configurations-example.integration.test.ts > Cache Type Configurations Example Integration > should import and execute cache type configurations example without errors
ðŸŒ Browser with IndexedDB detected - using IndexedDB

 âœ“ tests/ops/retrieve.test.ts (37 tests) 20ms
 âœ“ tests/examples/cache-map-example.integration.test.ts (1 test) 17ms
 âœ“ tests/examples/cache-type-configurations-example.integration.test.ts (1 test) 296ms
 âœ“ tests/memory/EnhancedMemoryCacheMap.test.ts (108 tests | 12 skipped) 22ms
stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Statistics and Cleanup > should handle statistics with mixed expired and valid queries
(1763111335335) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stderr | tests/integration/CacheIntegration.test.ts > Cache Integration Tests > Error Handling and Edge Cases > should handle storage errors gracefully in browser implementations
(1763111335347) [ERROR] - [@fjell/cache] [LocalStorageCacheMap] Error storing to localStorage (attempt 1/3) [{"key":{"kt":"test","pk":"1"},"value":{"key":{"kt":"test","pk":"1"},"id":"1","name":"Test Item","value":100},"error":{},"isLastAttempt":false}]
(1763111335347) [ERROR] - [@fjell/cache] [LocalStorageCacheMap] Error storing to localStorage (attempt 2/3) [{"key":{"kt":"test","pk":"1"},"value":{"key":{"kt":"test","pk":"1"},"id":"1","name":"Test Item","value":100},"error":{},"isLastAttempt":false}]
(1763111335348) [ERROR] - [@fjell/cache] [LocalStorageCacheMap] Error storing to localStorage (attempt 3/3) [{"key":{"kt":"test","pk":"1"},"value":{"key":{"kt":"test","pk":"1"},"id":"1","name":"Test Item","value":100},"error":{},"isLastAttempt":true}]

stderr | tests/contained/Cache.test.ts > Combined Item Cache Tests > should throw error when setting item with mismatched keys
(1763111335353) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"} != {"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000","loc":[{"kt":"container","lk":"123e4567-e89b-12d3-a456-426614174100"}]}

 âœ“ tests/integration/CacheIntegration.test.ts (15 tests) 16ms
 âœ“ tests/contained/Cache.test.ts (16 tests) 13ms
stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Debug Logging > should log operations when debug is enabled
[QueryCache] Stored query result: debug-query
  - Items: 1
  - Complete: true
  - TTL: 300s
  - Expires: 2025-11-14T09:13:55.375Z

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Debug Logging > should log operations when debug is enabled
[QueryCache] Cache hit for query: debug-query (1 items, complete: true)

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Debug Logging > should log operations when debug is enabled
[QueryCache] Invalidated 1 queries matching pattern: debug.*

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Debug Logging > should log operations when debug is enabled
[QueryCache] Cache miss for query: debug-query

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Debug Logging > should log operations when debug is enabled
[QueryCache] Cleared 0 query results

stderr | tests/events/CacheEventEmitter.test.ts > CacheEventEmitter > event emission > should handle listener errors gracefully
Error in cache event listener: Error: Test error
    at ~/gitw/getfjell/cache/tests/events/CacheEventEmitter.test.ts:125:15
    at Mock (file://~/gitw/getfjell/cache/node_modules/@vitest/spy/dist/index.js:266:34)
    at CacheEventEmitter.emitToSubscription (~/gitw/getfjell/cache/src/events/CacheEventEmitter.ts:328:9)
    at CacheEventEmitter.emit (~/gitw/getfjell/cache/src/events/CacheEventEmitter.ts:182:14)
    at ~/gitw/getfjell/cache/tests/events/CacheEventEmitter.test.ts:136:28
    at Proxy.assertThrows (file://~/gitw/getfjell/cache/node_modules/chai/index.js:2800:5)
    at Proxy.methodWrapper (file://~/gitw/getfjell/cache/node_modules/chai/index.js:1701:25)
    at Proxy.<anonymous> (file://~/gitw/getfjell/cache/node_modules/@vitest/expect/dist/index.js:1145:12)
    at Proxy.overwritingMethodWrapper (file://~/gitw/getfjell/cache/node_modules/chai/index.js:1751:33)
    at Proxy.<anonymous> (file://~/gitw/getfjell/cache/node_modules/@vitest/expect/dist/index.js:1481:16)
    at Proxy.<anonymous> (file://~/gitw/getfjell/cache/node_modules/@vitest/expect/dist/index.js:1086:14)
    at Proxy.methodWrapper (file://~/gitw/getfjell/cache/node_modules/chai/index.js:1701:25)
    at ~/gitw/getfjell/cache/tests/events/CacheEventEmitter.test.ts:136:45
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:157:11
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:753:26
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1602:10)
    at runTest (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1309:12)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runSuite (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1468:8)
    at runFiles (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1526:3)
    at startTests (file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:1559:3)
    at file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:76:64
    at withEnv (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:57:3)
    at run (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:72:144)
    at runBaseTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/base.BYPMk0VN.js:122:2)
    at executeTests (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init-forks.WglB-sfY.js:24:4)
    at execute (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:99:3)
    at process.onMessage (file://~/gitw/getfjell/cache/node_modules/vitest/dist/chunks/init.94FWN9pW.js:164:20)

 âœ“ tests/events/CacheEventEmitter.test.ts (41 tests) 14ms
stderr | tests/ops/one.test.ts > one operation > when bypassCache is enabled > should handle API errors properly
(1763111335435) [ERROR] - [@fjell/cache] [one] API request failed [{"query":{"compoundCondition":{"compoundType":"AND","conditions":[{"column":"id","value":"1","operator":"=="}]}},"locations":[],"error":{}}]

 âœ“ tests/eviction/EvictionStrategyValidation.test.ts (82 tests) 13ms
stderr | tests/utils/EvictionStrategies.edge-cases.test.ts > Eviction Strategies Edge Cases and Comprehensive Tests > createEvictionStrategy factory edge cases > should handle extreme configuration values for enhanced strategies
sketchWidth should be at least 16 for optimal performance, got 1. Correcting to 16.
adaptiveLearningRate must be between 0 and 10, got 100. Correcting to 10.

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Metadata Provider Methods > should delegate metadata operations to underlying cache
(1763111335436) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stderr | tests/utils/EvictionStrategies.edge-cases.test.ts > Eviction Strategies Edge Cases and Comprehensive Tests > createEvictionStrategy factory edge cases > should handle invalid configuration values gracefully
decayFactor must be between 0 and 1, got -0.5. Correcting to 0.
sketchWidth must be positive, got 0. Correcting to 1024.
sketchDepth must be positive, got -1. Correcting to 4.
decayFactor must be between 0 and 1, got -0.5. Correcting to 0.
sketchWidth must be positive, got 0. Correcting to 1024.
sketchDepth must be positive, got -1. Correcting to 4.

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Metadata Provider Methods > should handle metadata operations when underlying cache doesn't support them
(1763111335437) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Metadata Provider Methods > should get current size from underlying cache
(1763111335437) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Metadata Provider Methods > should get size limits from underlying cache
(1763111335437) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Cache Map Interface Compliance > should pass through keys() operation
(1763111335437) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Cache Map Interface Compliance > should pass through values() operation
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Cache Map Interface Compliance > should create a clone of the cache
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Cache Map Interface Compliance > should create a clone of the cache
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Metadata Extraction > should extract query type from hash correctly
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Metadata Extraction > should extract filter information from query hash
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Query Metadata Extraction > should handle malformed query hashes gracefully
(1763111335438) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > CacheMap Abstract Methods > should implement invalidateItemKeys
(1763111335439) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > CacheMap Abstract Methods > should implement invalidateLocation
(1763111335439) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > CacheMap Abstract Methods > should implement clearQueryResults
(1763111335439) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Error Handling > should handle underlying cache errors gracefully
(1763111335439) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Error Handling > should handle query operations when queries don't exist
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Options and Configuration > should use default options when not provided
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Options and Configuration > should respect debug option in logging
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Options and Configuration > should respect debug option in logging
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Options and Configuration > should handle different TTL configurations
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Complex Scenarios > should handle rapid query invalidation and recreation
(1763111335440) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Complex Scenarios > should handle large numbers of queries efficiently
(1763111335441) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/cache/layers/TwoLayerCacheMap.test.ts > TwoLayerCacheMap > Complex Scenarios > should handle query results with complex item key structures
(1763111335442) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stderr | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should handle various API response scenarios and edge cases
(1763111335454) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"edge","pk":"null-error"},"message":"Null error test","stack":"Error: Null error test
    at Object.get (~/gitw/getfjell/cache/tests/examples/basic-cache-example.integration.test.ts:373:35)
    at executeGetLogic (~/gitw/getfjell/cache/src/ops/get.ts:166:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ~/gitw/getfjell/cache/src/ops/get.ts:70:14
    at ~/gitw/getfjell/cache/node_modules/@fjell/core/dist/index.js:1872:22
    at get (~/gitw/getfjell/cache/src/ops/get.ts:74:18)"}]

stderr | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should handle various API response scenarios and edge cases
(1763111335455) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"edge","pk":"undefined-error"},"message":"Undefined error test","stack":"Error: Undefined error test
    at Object.get (~/gitw/getfjell/cache/tests/examples/basic-cache-example.integration.test.ts:376:35)
    at executeGetLogic (~/gitw/getfjell/cache/src/ops/get.ts:166:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ~/gitw/getfjell/cache/src/ops/get.ts:70:14
    at ~/gitw/getfjell/cache/node_modules/@fjell/core/dist/index.js:1872:22
    at get (~/gitw/getfjell/cache/src/ops/get.ts:74:18)"}]

stderr | tests/examples/basic-cache-example.integration.test.ts > Basic Cache Example Integration Tests > Basic Cache Operations Example > should handle various API response scenarios and edge cases
(1763111335455) [ERROR] - [@fjell/cache] [get] Error getting item for key [{"key":{"kt":"edge","pk":"missing"},"message":"Edge case item not found: missing","stack":"Error: Edge case item not found: missing
    at Object.get (~/gitw/getfjell/cache/tests/examples/basic-cache-example.integration.test.ts:378:33)
    at executeGetLogic (~/gitw/getfjell/cache/src/ops/get.ts:166:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ~/gitw/getfjell/cache/src/ops/get.ts:70:14
    at ~/gitw/getfjell/cache/node_modules/@fjell/core/dist/index.js:1872:22
    at get (~/gitw/getfjell/cache/src/ops/get.ts:74:18)"}]

 âœ“ tests/utils/EvictionStrategies.edge-cases.test.ts (32 tests) 14ms
 âœ“ tests/ops/one.test.ts (20 tests) 15ms
 âœ“ tests/cache/layers/TwoLayerCacheMap.test.ts (43 tests) 367ms
 âœ“ tests/examples/basic-cache-example.integration.test.ts (8 tests) 192ms
stderr | tests/ops/action.test.ts > action operation > input validation > should throw error for invalid item key
(1763111335469) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in action [{"key":{"invalid":"key"},"coordinate":{"kta":["test"],"scopes":["container"]}}]

stderr | tests/ops/action.test.ts > action operation > input validation > should validate key before any cache operations
(1763111335471) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in action [{"key":{"kt":"test"},"coordinate":{"kta":["test"],"scopes":["container"]}}]

stderr | tests/ops/action.test.ts > action operation > eviction key parsing error handling > should handle malformed evicted keys gracefully
(1763111335474) [ERROR] - [@fjell/cache] [action] Failed to parse evicted key during deletion [{"evictedKey":"invalid-json","error":"Unexpected token 'i', "invalid-json" is not valid JSON"}]

stderr | tests/ops/action.test.ts > action operation > eviction key parsing error handling > should handle malformed evicted keys gracefully
(1763111335474) [ERROR] - [@fjell/cache] [action] Failed to parse evicted key during deletion [{"evictedKey":"{incomplete json","error":"Expected property name or '}' in JSON at position 1 (line 1 column 2)"}]

stderr | tests/ops/action.test.ts > action operation > eviction key parsing error handling > should continue processing when JSON parse fails on evicted keys
(1763111335474) [ERROR] - [@fjell/cache] [action] Failed to parse evicted key during deletion [{"evictedKey":"undefined","error":""undefined" is not valid JSON"}]
(1763111335474) [ERROR] - [@fjell/cache] [action] Failed to parse evicted key during deletion [{"evictedKey":"{circular_ref}","error":"Expected property name or '}' in JSON at position 1 (line 1 column 2)"}]

stderr | tests/ops/action.test.ts > action operation > eviction key parsing error handling > should continue processing when JSON parse fails on evicted keys
(1763111335474) [ERROR] - [@fjell/cache] [action] Failed to parse evicted key during deletion [{"evictedKey":"invalid","error":"Unexpected token 'i', "invalid" is not valid JSON"}]

 âœ“ tests/ops/action.test.ts (24 tests) 14ms
 âœ“ tests/examples/memory-leak-prevention.integration.test.ts (34 tests) 15ms
 âœ“ tests/patterns/StaleWhileRevalidate.test.ts (13 tests) 461ms
stderr | tests/ops/find-operations.test.ts > Find Operations > find operation with bypassCache enabled > should handle API errors properly
(1763111335533) [ERROR] - [@fjell/cache] [find] API request failed [{"finder":"by-value","params":{"value":100},"locations":[],"error":{}}]

 âœ“ tests/InstanceFactory.test.ts (63 tests) 14ms
stderr | tests/ops/find-operations.test.ts > Find Operations > findOne operation with bypassCache enabled > should handle API errors properly
(1763111335537) [ERROR] - [@fjell/cache] [findOne] API request failed [{"finder":"by-id","finderParams":{"id":"1"},"locations":[],"error":{}}]

 âœ“ tests/ops/find-operations.test.ts (27 tests) 13ms
stderr | tests/ops/remove.test.ts > remove operation > input validation > should throw error for empty object
(1763111335579) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in remove [{"key":{},"coordinate":{"kta":["test"],"scopes":[]}}]

stderr | tests/ops/remove.test.ts > remove operation > input validation > should throw error for malformed key
(1763111335580) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in remove [{"key":{"invalid":"key"},"coordinate":{"kta":["test"],"scopes":[]}}]

stderr | tests/ops/remove.test.ts > remove operation > input validation > should throw error for incomplete primary key
(1763111335580) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in remove [{"key":{"kt":"test"},"coordinate":{"kta":["test"],"scopes":[]}}]

stderr | tests/ops/remove.test.ts > remove operation > input validation > should throw error for null pk
(1763111335581) [ERROR] - [@fjell/cache] [remove] Key for Remove is not a valid ItemKey: {"kt":"test","pk":null}

stderr | tests/ops/remove.test.ts > remove operation > input validation > should throw error for empty string pk
(1763111335581) [ERROR] - [@fjell/cache] [remove] Key for Remove is not a valid ItemKey: {"kt":"test","pk":""}

stderr | tests/ops/remove.test.ts > remove operation > error handling > should propagate API errors and not delete from cache
(1763111335583) [ERROR] - [@fjell/cache] [remove] Error deleting item [{"error":{}}]

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Cleanup Operations > should handle cleanup with debug logging enabled
[QueryCache] Stored query result: debug-query1
  - Items: 1
  - Complete: true
  - TTL: 0.05s
  - Expires: 2025-11-14T09:08:55.631Z

stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Cleanup Operations > should handle cleanup with debug logging enabled
[QueryCache] Stored query result: debug-query2
  - Items: 1
  - Complete: true
  - TTL: 0.05s
  - Expires: 2025-11-14T09:08:55.631Z

stderr | tests/ops/remove.test.ts > remove operation > error handling > should handle network errors
(1763111335584) [ERROR] - [@fjell/cache] [remove] Error deleting item [{"error":{}}]

stderr | tests/ops/remove.test.ts > remove operation > error handling > should handle API errors with additional properties
(1763111335584) [ERROR] - [@fjell/cache] [remove] Error deleting item [{"error":{}}]

stderr | tests/ops/remove.test.ts > remove operation > operation sequence > should not call cache deletion if API call fails
(1763111335584) [ERROR] - [@fjell/cache] [remove] Error deleting item [{"error":{}}]

stderr | tests/ops/remove.test.ts > remove operation > comprehensive error scenarios > should handle API remove throwing synchronously
(1763111335586) [ERROR] - [@fjell/cache] [remove] Error deleting item [{"error":{}}]

stderr | tests/ops/update.test.ts > update operation > validation and error handling > should throw error for invalid key
(1763111335590) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in update [{"key":{"kt":"test"},"coordinate":{"kta":["test"],"scopes":[]}}]

stderr | tests/ops/all.test.ts > all operation > when bypassCache is enabled > should handle API errors properly
(1763111335590) [ERROR] - [@fjell/cache] [all] API request failed [{"query":{"limit":10},"locations":[{"kt":"container","lk":"container1"}],"error":{}}]

stderr | tests/ops/update.test.ts > update operation > validation and error handling > should throw error for malformed key
(1763111335591) [ERROR] - [@fjell/core] [validation],[KeyValidator] Invalid key structure in update [{"key":{"kt":"test"},"coordinate":{"kta":["test"],"scopes":[]}}]

stderr | tests/ops/update.test.ts > update operation > validation and error handling > should propagate API errors
(1763111335591) [ERROR] - [@fjell/cache] [update] Error updating item [{"error":{}}]

stderr | tests/ops/update.test.ts > update operation > validation and error handling > should handle network timeouts
(1763111335592) [ERROR] - [@fjell/cache] [update] Error updating item [{"error":{}}]

 âœ“ tests/ops/remove.test.ts (20 tests) 11ms
 âœ“ tests/ops/all.test.ts (17 tests) 12ms
 âœ“ tests/ops/update.test.ts (16 tests) 12ms
stdout | tests/examples/cache-type-configurations-example.test.ts
ðŸš€ Cache Type Configuration Examples

1ï¸âƒ£ Memory Cache Configuration
Best for: Fast access, temporary data, development
âœ… Memory cache configured with:
   - Max items: 1000
   - TTL: undefinedms (0s)
   - Debug logging: true
   - Auto sync: true
   - Max retries: 3

2ï¸âƒ£ IndexedDB Cache Configuration
Best for: Large datasets, offline capability, persistent storage
âœ… IndexedDB cache configured with:
   - Database: UserAppCache
   - Version: 2
   - Store: users
   - Debug logging: false
   - Max retries: 5
   - Retry delay: 2000ms

3ï¸âƒ£ localStorage Cache Configuration
Best for: User preferences, settings, moderate-sized persistent data
âœ… localStorage cache configured with:
   - Key prefix: "myapp:users:"
   - Compression: true
   - Auto sync: false
   - Max retries: 2
   - Default expiration: 7200000ms (7200s)

4ï¸âƒ£ Environment-Based Configuration
Automatically select optimal cache based on environment
ðŸ–¥ï¸  Node.js or limited browser environment - using memory cache
âœ… Optimal configuration selected


stderr | tests/events/CacheEventIntegration.test.ts > Cache Event Integration > error handling > should continue emitting events even if a listener throws
Error in cache event listener: Error: Test listener error
    at ~/gitw/getfjell/cache/tests/events/CacheEventIntegration.test.ts:403:15
    at Mock (file://~/gitw/getfjell/cache/node_modules/@vitest/spy/dist/index.js:266:34)
    at CacheEventEmitter.emitToSubscription (~/gitw/getfjell/cache/src/events/CacheEventEmitter.ts:328:9)
    at CacheEventEmitter.emit (~/gitw/getfjell/cache/src/events/CacheEventEmitter.ts:182:14)
    at set (~/gitw/getfjell/cache/src/ops/set.ts:150:16)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ~/gitw/getfjell/cache/tests/events/CacheEventIntegration.test.ts:413:7
    at file://~/gitw/getfjell/cache/node_modules/@vitest/runner/dist/index.js:753:20

 âœ“ tests/CacheMap.test.ts (40 tests) 10ms
 âœ“ tests/events/CacheEventIntegration.test.ts (15 tests) 13ms
 âœ“ tests/events/CacheEventFactory.test.ts (21 tests) 6ms
 âœ“ tests/examples/cache-type-configurations-example.test.ts (32 tests) 11ms
 âœ“ tests/eviction/strategies/ARCEvictionStrategy.test.ts (41 tests) 9ms
stderr | tests/primary/Cache.test.ts > PItemCache > should throw error when setting item with mismatched keys
(1763111335649) [ERROR] - [@fjell/cache] [set] Key does not match item key: {"kt":"whatever","pk":"123e4567-e89b-12d3-a456-426614174000"} != {"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"}

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should prevent cache poisoning from partial faceted query results
(1763111335649) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should prevent cache poisoning from partial faceted query results
ðŸ§ª Testing Cache Poisoning Prevention...
ðŸ“Š Step 1: Running faceted Graphics Report query...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should prevent cache poisoning from partial faceted query results
ðŸ“ Faceted query returned 1 item(s):
   - GPH: Graphics
ðŸ“Š Step 2: Running complete query for all phases...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should prevent cache poisoning from partial faceted query results
ðŸ“ Complete query returned 5 items:
   - GPH: Graphics
   - CUT: Cutting
   - FIN: Finishing
   - QC: Quality Control
   - SHP: Shipping
âœ… Cache poisoning prevention successful!
   Faceted query (1 item) did NOT poison complete query (5 items)

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should cache complete queries but not use them for partial results
(1763111335654) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should cache complete queries but not use them for partial results
ðŸ§ª Testing Query Completeness Isolation...
ðŸ“Š Step 1: Running complete query first...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should cache complete queries but not use them for partial results
ðŸ“Š Step 2: Running complete query again (should be cached)...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should cache complete queries but not use them for partial results
ðŸ“Š Step 3: Running faceted query (should call API)...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should cache complete queries but not use them for partial results
âœ… Query completeness isolation working correctly!

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should use different TTLs for complete vs partial queries
(1763111335655) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should use different TTLs for complete vs partial queries
ðŸ§ª Testing Different TTL Behavior...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should use different TTLs for complete vs partial queries
âœ… TTL configuration verified in implementation

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should maintain item cache independence from query cache
(1763111335655) [INFO] - [@fjell/cache] [TwoLayerCacheMap] TwoLayerCacheMap initialized [{"underlyingType":"memory/memory","itemTTL":3600,"queryTTL":300,"facetTTL":60}]

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should maintain item cache independence from query cache
ðŸ§ª Testing Item Cache Independence...

stdout | tests/integration/CachePoisoningPrevention.test.ts > Cache Poisoning Prevention > should maintain item cache independence from query cache
âœ… Item cache independence maintained!

 âœ“ tests/primary/Cache.test.ts (13 tests) 12ms
 âœ“ tests/integration/CachePoisoningPrevention.test.ts (4 tests) 9ms
stdout | tests/cache/layers/QueryCache.test.ts > QueryCache > Cleanup Operations > should handle cleanup with debug logging enabled
[QueryCache] Cleaned up 2 expired query results

 âœ“ tests/cache/layers/QueryCache.test.ts (36 tests) 664ms
stderr | tests/Aggregator.test.ts > Aggregator > should throw an error if a mandatory reference is missing
(1763111335699) [ERROR] - [@fjell/cache] [ItemAggregator] Item does not have mandatory ref with key, not optional  [{"key":"other","item":{"key":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"events":{"created":{"at":{}},"updated":{"at":{}},"deleted":{"at":null}},"refs":{}}}]

stderr | tests/Aggregator.test.ts > Aggregator > should throw error for missing non-optional references
(1763111335702) [ERROR] - [@fjell/cache] [ItemAggregator] Item does not have mandatory ref with key, not optional  [{"key":"other","item":{"key":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"events":{"created":{"at":{}},"updated":{"at":{}},"deleted":{"at":null}},"refs":{}}}]

stderr | tests/Aggregator.test.ts > Aggregator > should throw error for missing references entirely
(1763111335702) [ERROR] - [@fjell/cache] [ItemAggregator] Item does not have refs an is not optional  [{"item":{"key":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"events":{"created":{"at":{}},"updated":{"at":{}},"deleted":{"at":null}}}}]

stderr | tests/Aggregator.test.ts > Aggregator > should populate an item with events that is missing events
(1763111335702) [ERROR] - [@fjell/cache] [ItemAggregator] Item does not have mandatory event with key [{"key":"created","item":{"key":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"events":{"updated":{"at":{}},"deleted":{"at":null}}}}]

stderr | tests/Aggregator.test.ts > Aggregator > should populate an item with events when the by key is missing
(1763111335703) [ERROR] - [@fjell/cache] [ItemAggregator] populateEvent with an Event that does not have by [{"event":{"at":{}},"ik":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"eventKey":"created"}]

stderr | tests/Aggregator.test.ts > Aggregator > should throw an error if a mandatory event is missing
(1763111335703) [ERROR] - [@fjell/cache] [ItemAggregator] Item does not have mandatory event with key [{"key":"created","item":{"key":{"kt":"test","pk":"123e4567-e89b-12d3-a456-426614174000"},"events":{},"refs":{}}}]

 âœ“ tests/normalization.test.ts (37 tests) 8ms
 âœ“ tests/Aggregator.test.ts (24 tests) 12ms
 âœ“ tests/utils/CacheSize.edge-cases.test.ts (30 tests) 7ms
 âœ“ tests/ops/allAction.test.ts (20 tests) 9ms
 âœ“ tests/eviction/strategies/FIFOEvictionStrategy.test.ts (26 tests) 6ms
stderr | tests/eviction/EvictionManager.test.ts > EvictionManager > error handling > should handle strategy errors gracefully
(1763111335756) [ERROR] - [@fjell/cache] [EvictionManager] Error in eviction strategy onItemAccessed [{"key":"key","error":{}}]

stderr | tests/eviction/EvictionManager.test.ts > EvictionManager > error handling > should handle strategy errors gracefully
(1763111335757) [ERROR] - [@fjell/cache] [EvictionManager] Error in eviction strategy onItemAdded [{"key":"key","error":{}}]

stderr | tests/eviction/EvictionManager.test.ts > EvictionManager > error handling > should handle strategy errors gracefully
(1763111335757) [ERROR] - [@fjell/cache] [EvictionManager] Error in eviction strategy onItemRemoved [{"key":"key","error":{}}]

stderr | tests/eviction/EvictionManager.test.ts > EvictionManager > error handling > should handle strategy errors gracefully
(1763111335757) [ERROR] - [@fjell/cache] [EvictionManager] Error in manual eviction [{"error":{}}]

 âœ“ tests/eviction/EvictionManager.test.ts (10 tests) 6ms
 âœ“ tests/warming/CacheWarmer.test.ts (20 tests) 760ms
       âœ“ should handle operation timeout  501ms
 âœ“ tests/Options.enhanced.test.ts (20 tests) 6ms
stderr | tests/ttl/TTLManager.test.ts > TTLManager > error handling and boundary conditions > should handle onItemAdded with missing metadata
(1763111335824) [WARNING] - [@fjell/cache] [TTLManager] TTL_DEBUG: No metadata found for item when setting TTL [{"key":"nonexistent-key","metadataProviderType":"MockMetadataProvider","metadataProviderMethods":["constructor","getMetadata","setMetadata","deleteMetadata","getAllMetadata","clearMetadata","getCurrentSize","getSizeLimits","setCurrentSize","setSizeLimits"]}]

 âœ“ tests/ttl/TTLManager.test.ts (52 tests) 7ms
 âœ“ tests/Options.test.ts (38 tests) 6ms
 âœ“ tests/ttl/TTLCalculator.test.ts (28 tests) 6ms
 âœ“ tests/Operations.test.ts (11 tests) 8ms
 âœ“ tests/integration/OptionsIntegration.test.ts (10 tests) 8ms
 âœ“ tests/examples/cache-configuration-example.test.ts (8 tests) 7ms
 âœ“ tests/utils/EvictionStrategies.test.ts (19 tests) 7ms
 âœ“ tests/examples/aggregator-example.integration.test.ts (1 test) 7ms
 âœ“ tests/Aggregator.extended.test.ts (9 tests) 6ms
 âœ“ tests/integration/CacheTTLEviction.integration.test.ts (11 tests) 7ms
 âœ“ tests/integration/query-invalidation.test.ts (4 tests) 8ms
 âœ“ tests/eviction/strategies/TwoQueueEvictionStrategy.test.ts (20 tests) 5ms
 âœ“ tests/eviction/strategies/MRUEvictionStrategy.test.ts (18 tests) 6ms
 âœ“ tests/Cache.string-number-keys.test.ts (4 tests) 6ms
 âœ“ tests/eviction/EvictionStrategyConfig.test.ts (17 tests) 4ms
 âœ“ tests/ops/reset.test.ts (23 tests) 5ms
 âœ“ tests/utils/CacheSize.test.ts (18 tests) 5ms
stderr | tests/utils/cacheInvalidation.test.ts > Cache Invalidation Utils > invalidateCachesByKeyTypes > should handle registry.get throwing error
(1763111336021) [WARNING] - [@fjell/cache] [cache],[utils],[cacheInvalidation] Failed to handle location-based invalidation [{"keyTypes":["order"],"error":"Registry error"}]
(1763111336021) [WARNING] - [@fjell/cache] [cache],[utils],[cacheInvalidation] Failed to handle location-based invalidation [{"keyTypes":["customer"],"error":"Registry error"}]

 âœ“ tests/utils/cacheInvalidation.test.ts (10 tests) 5ms
 âœ“ tests/eviction/strategies/RandomEvictionStrategy.test.ts (10 tests) 7ms
 âœ“ tests/CacheStats.test.ts (24 tests) 6ms
 âœ“ tests/examples/cache-size-and-eviction-example.test.ts (16 tests) 5ms
 âœ“ tests/ops/facet.test.ts (5 tests) 4ms
 âœ“ tests/Instance.integration.test.ts (11 tests) 5ms
 âœ“ tests/Instance.test.ts (13 tests) 4ms
 âœ“ tests/CacheInfo.test.ts (4 tests) 4ms
 âœ“ tests/Registry.test.ts (7 tests) 3ms
 âœ“ tests/Cache.integration.test.ts (6 tests) 4ms
 âœ“ tests/Cache.test.ts (3 tests) 3ms
stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Statistics and Monitoring > should cleanup and log when debug enabled
[ItemCache] Stored item: debug-key (expires: 2025-11-14T09:08:56.578Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Logging > should log operations when debug enabled
[ItemCache] Stored item: debug-key (expires: 2025-11-14T10:08:56.531Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Logging > should log operations when debug enabled
[ItemCache] Cache hit for key: debug-key

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Logging > should log operations when debug enabled
[ItemCache] Cache hit for key: debug-key

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Logging > should log operations when debug enabled
[ItemCache] Deleted item: debug-key (existed: true)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Logging > should log operations when debug enabled
[ItemCache] Cleared 0 items

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Statistics Accuracy > should accurately count mixed valid and expired items
[ItemCache] Cleaned up 1 expired items

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should provide detailed logging in debug mode
[ItemCache] Stored item: debug-operations-key (expires: 2025-11-14T10:08:56.742Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should provide detailed logging in debug mode
[ItemCache] Cache hit for key: debug-operations-key

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should provide detailed logging in debug mode
[ItemCache] Deleted item: debug-operations-key (existed: true)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should provide detailed logging in debug mode
[ItemCache] Cleared 0 items

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should handle expired item logging in debug mode
[ItemCache] Stored item: expiring-debug-key (expires: 2025-11-14T09:08:56.792Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should handle expired item logging in debug mode
[ItemCache] Expired item removed: expiring-debug-key

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should handle cleanup logging in debug mode
[ItemCache] Stored item: cleanup-debug-1 (expires: 2025-11-14T09:08:56.894Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should handle cleanup logging in debug mode
[ItemCache] Stored item: cleanup-debug-2 (expires: 2025-11-14T09:08:56.894Z)

stdout | tests/cache/layers/ItemCache.test.ts > ItemCache > Debug Mode Behaviors > should handle cleanup logging in debug mode
[ItemCache] Cleaned up 2 expired items

 âœ“ tests/cache/layers/ItemCache.test.ts (37 tests) 1929ms
       âœ“ should use custom TTL when provided  1101ms
 âœ“ tests/integration/TTLPersistence.integration.test.ts (3 tests) 2613ms
     âœ“ should persist TTL metadata and validate expiration across cache lifecycle  2507ms
 âœ“ tests/examples/cache-stats-example.test.ts (9 tests) 9845ms
     âœ“ should calculate hit ratio correctly  4868ms
     âœ“ should handle cache operations that result in errors gracefully  4966ms

âŽ¯âŽ¯âŽ¯âŽ¯ Unhandled Rejection âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯
Error: ENOENT: no such file or directory, open '~/gitw/getfjell/cache/coverage/.tmp/coverage-73.json'
 â¯ open node:internal/fs/promises:642:25
 â¯ Object.writeFile node:internal/fs/promises:1249:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯
Serialized Error: { errno: -2, code: 'ENOENT', syscall: 'open', path: '~/gitw/getfjell/cache/coverage/.tmp/coverage-73.json' }



